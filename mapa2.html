<!DOCTYPE html>
<html>
  <head>
    <title>Golf y Minigolf cerca de ti</title>
    <meta charset="utf-8" />
    <style>
      body{
        margin: 0;
        padding: 0;
      }
      #map {
        height: 100vh;
        width: 100vw;
      }
    </style>
    <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD7Cb8Nv95YYdRov6Gky8MPuFyK6-E6rko&callback=initMap&libraries=places,marker&loading=async"
      async
      defer
    ></script>
  </head>
  <body>
    <div id="map"></div>

    <script>
      let map;
      let infoWindow;

      function initMap() {
        // Intentar obtener la ubicación del usuario
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(
            (position) => {
              const userLocation = {
                lat: position.coords.latitude,
                lng: position.coords.longitude,
              };

              // Crear el mapa centrado en la ubicación del usuario
              map = new google.maps.Map(document.getElementById("map"), {
                zoom: 13,
                center: userLocation,
                mapId: "717d7e50cbca8f3",
              });

              infoWindow = new google.maps.InfoWindow();

              // Marcador de ubicación del usuario
            new google.maps.Marker({
  map,
  position: userLocation,
  title: "Tú estás aquí",
  icon: {
  url: "https://maps.google.com/mapfiles/ms/icons/purple-dot.png",
     scaledSize: new google.maps.Size(40, 40)
  }
});

              // Buscar campos de golf cerca
              const service = new google.maps.places.PlacesService(map);
              const request = {
                location: userLocation,
                radius: 20000,
                query: "golf course",
              };

              service.textSearch(request, (results, status) => {
                if (status === google.maps.places.PlacesServiceStatus.OK) {
                  results.forEach((place) => {
                    const marker = new google.maps.marker.AdvancedMarkerElement({
                      map,
                      position: place.geometry.location,
                      title: place.name,
                    });

                    service.getDetails(
                      { placeId: place.place_id },
                      (details, status) => {
                        if (status === google.maps.places.PlacesServiceStatus.OK) {
                          const address = details.formatted_address || "Dirección no disponible";
                          marker.addListener("click", () => {
                            infoWindow.setContent(
                              `<h4>${place.name}</h4><p>${address}</p><a href="https://www.google.com/maps?q=${place.geometry.location.lat()},${place.geometry.location.lng()}" target="_blank">Ver en Google Maps</a>`
                            );
                            infoWindow.open(map, marker);
                          });
                        }
                      }
                    );
                  });
                } else {
                  alert("No se encontraron campos de golf cerca de tu ubicación.");
                }
              });
            },
            () => {
              alert("No se pudo obtener tu ubicación.");
            }
          );
        } else {
          alert("Tu navegador no soporta geolocalización.");
        }
      }
    </script>
  </body>
</html>
